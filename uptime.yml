- name: Check Uptime vÃ  XÃ¡c Ä‘á»‹nh Inventory gá»‘c
  hosts: all-linux
  gather_facts: no
  tasks:
    - name: XÃ¡c Ä‘á»‹nh Inventory gá»‘c cá»§a tá»«ng host
      set_fact:
        inventory_root: >-
          {{
            groups.keys()
            | select("search", "^(?!all|ungrouped|linux|win|all-linux|all-win).*")
            | select("extract", groups, inventory_hostname in groups.values())
            | list | first | default("Unknown")
          }}

    - name: Láº¥y uptime cá»§a mÃ¡y chá»§
      command: uptime -p
      register: uptime_result

    - name: Hiá»ƒn thá»‹ káº¿t quáº£ uptime vÃ  inventory gá»‘c
      debug:
        msg: "ðŸ“Œ MÃ¡y chá»§ {{ inventory_hostname }} (Inventory gá»‘c: {{ inventory_root }}) Ä‘Ã£ cháº¡y Ä‘Æ°á»£c: {{ uptime_result.stdout }}"

    - name: Gá»­i káº¿t quáº£ lÃªn Telegram
      uri:
        url: "https://api.telegram.org/bot<BOT_TOKEN>/sendMessage"
        method: POST
        body:
          chat_id: "-4132281180"
          text: "ðŸ“¢ MÃ¡y chá»§ *{{ inventory_hostname }}* thuá»™c *{{ inventory_root }}* Ä‘Ã£ cháº¡y Ä‘Æ°á»£c: *{{ uptime_result.stdout }}*"
          parse_mode: "Markdown"
        body_format: json
        headers:
          Content-Type: "application/json"
